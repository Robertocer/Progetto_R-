---
title: "Analisi dei Terremoti e delle faglie nel mondo (1970-2025)"
output:
  pdf_document: default
  html_document: default
  word_document: default
date: ""
---
# Introduzione
In questo lavoro di gruppo, abbiamo deciso di analizzare un dataset preso [USGS.gov](https://earthquake.usgs.gov/earthquakes/search/), che contiene varie informazioni sui 
terremoti avvenuti in tutti il mondo dal 1970 al 2025. Il dataset è stato selezionato in modo da avere  solo terremoti di magnitudo superiore a 5.0 della scala Richter. Ci siamo limitati a questa magnitudo in quanto il sito consente di scaricare fino a 20.000 eventi la volta, quindi per coprire tutta la serie storica è stato necessario unificare tutte le richieste creando un unico dataset con 87798. Inoltre, dal sito [globalquakemodel.org](https://www.globalquakemodel.org/) il quale contiene la mappa di tutte le faglie attive nel mondo. In questo modo abbiamo potuto confrontare le posizioni dei terremoti rispetto alle faglie. I dati sono stati analizzati tenendo conto sia della loro posizione geografica e di altre caratteristiche presenti nel dataset e  sia della loro frequenza nel corso del tempo. Queste analisi sono state effettuate sia attraverso l'utilizzo di mappe, sia attraverso l'utilizzo di grafici al fine di descrivere al meglio tutte le variabili quantitative e qualitative presenti.

## Dataset Faglie
Il dataset contiene la mappa di tutte le faglie attive presenti nel mondo, ed è possibile importarlo tramite il seguente codice:
```{r echo=TRUE, message=FALSE}
library(readr)
library(sf)
library(ggplot2)
library(dplyr)
library(maps)
library(tidyr)
library(RColorBrewer)
library(stringr)
library(rnaturalearth)
library(rnaturalearthdata)
library(ggrepel)
library(lubridate)
```
Per semplicità si è deciso di presentare tutte le librerie utilizzate nel lavoro nel precedente blocco di codice.
```{r echo=TRUE, message=FALSE, warning=FALSE, error=FALSE}
faglie <- st_read("gem_active_faults.shp")
ggplot() +
  # Aggiungi la mappa del mondo
  borders("world", colour = "gray50", fill = "lightgray") + 
  # Aggiungi le faglie
  geom_sf(data = faglie, color = "red", size = 1, alpha = 0.7) +
  labs(title = "Faglie Geologiche Attive", x = "Longitudine", y = "Latitudine", 
           color = "Magnitudo") +
  theme_minimal(base_size = 14) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
    legend.position="right")
```
Nel grafico, viene mostrata la mappa nel mondo in grigio, e in rosso, le faglie geologiche attive. Come si può vedere le faglie si distribuiscono principalemente lungo i confini delle placche tettoniche con una forte concentrazione nella parte sud-ovest dell'Asia a formare la catena dell' Himalaya. 
La presenza di faglie geologiche è di particolare interesse in quanto nei pressi di queste zone si osserva una maggiore probabilità che vi siano terremoti. Questo fenomeno verrà visualizzato in seguito, attraverso il dataset "Earthquake" in cui è presente la lista dei terremoti registrati dal 1970-2025.

## Dataset Earthquake: 

I dati sono stati presi dal sito [USGS.gov](https://earthquake.usgs.gov/earthquakes/search/) filtrati con una magnitudo superiore a 5.0. Essendo la frequenza dei terremoti correlata alla magnitudo il sito consentiva solo di scaricare 20000 eventi per volta, producendo troppe richieste di dati all'ente fornitore. Inoltre, il dataset sull'intero fenomeno era piuttosto frammentato si è deciso quindi di unire le informazioni distribuite su diversi anni in un unico blocco per avere una visione globale del fenomeno. 

In R, i dati sono stati importati tramite il seguente codice:
```{r echo=TRUE}
terremoti <- read.csv("Earthquake_1970-2025.csv")

```


## Analisi Premilinare.

Il nostro dataset è composto da 22 variabili di varia natura per un totale di quasi 88000 osservazioni. Per semplicità, mostriamo un breve estratto delle variabili piu significative usate nell'analisi del fenomeno.


```{r echo=TRUE}
library(pander)
pander(head(terremoti %>% select(latitude, longitude, depth, mag, nst, type, time)))

```
Nella seguente tabella, le variabili indicano: 

-  __latitudine e longitudine__: rappresentano le coordinate geografiche di dove è avvenuto il terremoto.
-  __depth__: La profondità, misurata in km rispetto alla superficie terrestre.
- __mag__: la magnitudo del terremoto in scala Richter.
- __nst__: numero di stazioni che hanno registrato il terremoto. 
- __type__: l'origine del terremoto inteso come causa scatenante. (Terremoto terrestre, esplosione nucleare,                   collasso di miniere, frane ed esplosioni.)
- __time__:  data e ora della rilevazione del fenomeno.

Con la funzione summary mostriamo le caratteristiche delle variabili quantitative mensionate sopra.
```{r echo=TRUE}
pander(summary(terremoti %>% select(latitude, longitude)))
pander(summary(terremoti %>% select(depth, mag, nst)))
```
Ciò che è possibile notare è che per la variabile nst ci sono diversi dati mancanti (NA). Per la variabile depth, si può notare che la mediana e la media non coincidono, lasciando intendere in questa prima fase, la presenza di asimmetria nei dati. Maggiori conferme si hanno guardando la differenza tra il terzo quartile(3rd Qu) e il massimo(Max). Il terzo quartile della variabile mag, ci suggerisce che il 75% dei dati non supera il 5.5 di magnitudo. 


## Analisi Quantitativa
Come prima analisi, ci siamo concentrati sulle variabili quantitative cercando possibili correlazioni fra di esse. A tal fine abbiamo utilizzando la funzione "cor" del pacchetto stats, che di default utilizza il coefficiente di correlazione di Pearson. Per una maggiore interpetazione del valore dei coefficienti, si è deciso di utilizzare una heat map generata tramite il seguente codice. 

```{r echo=TRUE}
library(dplyr)
library(tidyr)
library(corrplot)
library(ggcorrplot)
##seleziono le variabili per l'analisi
df_corr= terremoti%>%
        dplyr::select(depth, mag, nst, gap, dmin, rms, horizontalError, depthError, 
                      magError, magNst)
df_na=df_corr %>%
        summarise(across(c(depth, mag, nst, gap, dmin, rms, horizontalError, 
                          depthError, magError, magNst), 
                   ~sum(is.na(.)))) 

#### seleziono le variabili da pulire da NA
df_corr_clean <- df_corr %>%
  drop_na(depth, mag, nst, gap, dmin, rms, horizontalError, 
            depthError, magError, magNst)      

#calcolo la matrice di correlazione
df_f=cor(df_corr_clean)


library(corrplot)

corrplot(df_f, 
         method = "color",    
         type = "full",      
         tl.cex = 0.8,        
         tl.srt = 45,         
         addCoef.col = "black",  
         number.cex = 0.7)    
```

Dalla heat map, si evince vi siano numerose correlazioni fra le variabili di cui, risultano di particolare interesse le seguenti: 

- __Mag e nst__: Queste due variabili appartengono rispettivamente al livello di magnitudo  e al numero di stazioni sismiche che hanno registrato il terremoto. Sono                   correlate positivamente in quanto un evento con alta magnitudo sarà rilevato da piu stazioni sismiche presenti nel mondo.
- __nst e gap__: Con un maggior numero di stazioni (nst elevato), la copertura attorno all'epicentro è più uniforme, riducendo il gap.
Al contrario, con meno stazioni la copertura è più concentrata, generando un gap più ampio.
- __Mag Error e magNst__:  Queste due variabili appartengono rispettivamente al livello di magnitudo  e al numero di stazioni sismiche che hanno partecipato alla determinazione della magnitudo. Per questo motivo osserviamo un coefficiente di correlazione negativo. 
- __Horizontal Error e dmin__:L'errore orizzontale potrebbe essere correlato alla distanza minima (dmin) perché terremoti più lontani dalla rete di rilevamento (maggiore dmin) tendono ad avere una localizzazione meno precisa, aumentando l'errore orizzontale. Questo è dovuto alla geometria della rete sismica e alla riduzione della precisione con la distanza.
- __Horizontal Error e depth error__: L'errore orizzontale e l'errore di profondità sono spesso correlati perché entrambi dipendono dalla qualità e dalla distribuzione dei dati sismici. Una scarsa copertura strumentale o una geometria sfavorevole possono influenzare simultaneamente la precisione della localizzazione sia in orizzontale che in profondità.



