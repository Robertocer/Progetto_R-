df_filtered <- terremoti %>%
filter(!type %in% c("rock burst", "mine collapse", "earthquake")) %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
scale_y_continuous(trans = "log") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
labs(y = 'Scala logaritmica', x = "Gruppi di Anni",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(!type %in% c("rock burst", "mine collapse", "earthquake")) %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
#scale_y_continuous(trans = "log") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
labs(y = '', x = "Gruppi di Anni",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(!type %in% c( "earthquake")) %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
labs(y = '', x = "Gruppi di Anni",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(!type %in% c( "earthquake")) %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
labs(y = '', x = "Gruppi di Anni",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
labs(y = '', x = "Gruppi di Anni",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
labs(y = '', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.margin = margin(0, 0, 0, 20))+
labs(y = '', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.margin = margin(0, 0, 0, 50))+
labs(y = '', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 0, 0, 80))+
labs(y = '', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 80, 0, 0))+
labs(y = '', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
labs(y = '', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_y_continuous(breaks = seq(0, 1, .2),
label = percent)+
labs(y = '', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set2") +
labs(y = 'Percent', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set1") +
labs(y = 'Percent', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set3") +
labs(y = 'Percent', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set4") +
labs(y = 'Percent', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set5") +
labs(y = 'Percent', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set1") +
labs(y = 'Percent', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set1") +
labs(y = 'Percent', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")+
theme_minimal()
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set1") +
labs(y = 'Percent', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set1") +
scale_y_continuous(breaks = seq(0, 1, .2), label = percent) +
labs(y = 'Percent', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set1") +
scale_y_continuous(breaks = seq(0, 1, .2), label = count) +
labs(y = 'Percent', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set1") +
scale_y_continuous(breaks = seq(0, 1, .2), label = year_group) +
labs(y = 'Percent', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
View(df_filtered)
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set1") +
scale_y_continuous(labels = scales::percent) +
labs(y = 'Percent', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set1") +
scale_y_continuous(labels = scales::percent) +
labs(y = 'Percentuale', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Proporzione in scala logaritmica dei vari terremoti")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set1") +
scale_y_continuous(labels = scales::percent) +
labs(y = 'Percentuale', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Percentuale delle tipologie di terremoti negli anni")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set1") +
scale_y_continuous(labels = scales::percent) +
labs(y = 'Percentuale', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Percentuale per tipologie di terremoti negli anni")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
ggplot(df_filtered, aes(x = year_group, fill = type, weight = count)) +
geom_bar(position = "fill") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.margin = margin(0, 50, 0, 0))+
scale_fill_brewer(palette = "Set1") +
scale_y_continuous(labels = scales::percent) +
labs(y = 'Percentuale', x = "Gruppi di Anni",
fill = "Tipologgia",
title = "Percentuale per tipologie di terremoti negli anni")
df_filtered <- terremoti %>%
filter(type != "earthquake") %>%
mutate(time = ymd_hms(time, tz = "UTC"),
year = year(time)) %>%
mutate(year_group = cut(year,
breaks = seq(min(year), max(year) + 5, by = 5),
include.lowest = TRUE,
right = FALSE)) %>%
group_by(type, year_group) %>%
summarise(count = n(), .groups = "drop")
